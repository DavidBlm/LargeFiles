package ba.intersection;
//TODO: x = (n-1)n/2
//TODO: m1 = m - 1, m2 = m1(m1+1)/2
component IntersectionController<N1 n = 2,N1 x = 1,N1 m = 5,N1 m1 = 4,N1 m2 = 10>{
//component IntersectionController{
    port in Q^{3,m} trajectoryIn[n];
    port in Q cutoffTime;
    port in B isActive;

    port out B stop[n];

    instance ConflictToStopLookup<n,x> conflictToStopLookup;
    instance ConflictComputer<n,x,m,m1,m2> conflictComputer;
    instance ConflictToStopConverter<n,x,m> conflictToStopConverter;

    connect trajectoryIn[:] -> conflictComputer.trajectory[:];
    connect cutoffTime -> conflictComputer.cutoffTimeIn;
    connect conflictComputer.conflictOut[:] -> conflictToStopConverter.conflictIn[:];
    connect conflictToStopLookup.indexLookup[:] -> conflictToStopConverter.indexLookupIn[:];
    connect conflictToStopConverter.stopOut[:] ->  stop[:];
    connect isActive -> conflictToStopConverter.active;
}