package ba;
import ba.intersection.IntersectionController;

component System{
    //Intersection
    instance IntersectionController intersectionController;

    ports in Q cutoffPosIn,
          in Q cutoffTimeIn,
          in B isActiveIn,
          in Q^{3,20} trajectory[2],
          out B stopOut[2];


    connect cutoffPosIn -> intersectionController.cutoffPos;
    connect cutoffTimeIn -> intersectionController.cutoffTime;
    connect isActiveIn -> intersectionController.isActive;
    connect trajectory[:] -> intersectionController.trajectoryIn[:];
    //TODO: into speed controller
    connect intersectionController.stop[:] -> stopOut[:];

    //Collision detection
    instance CollisionDetection collisionDetection;

    ports in Q^{2,4} hullsIn[2],
          out B collisionOut;

    connect hullsIn[:] -> collisionDetection.hulls[:];
    connect collisionDetection.collision -> collisionOut;
}