/* (c) https://github.com/MontiCore/monticore */
package cNNCalculator;

component Network<Z(2:oo) classes = 10>{
    ports in Z(0:255)^{1, 28, 28} data,
         out Q(0:1)^{classes} softmax;

    implementation CNN {
	def conv(channels=20, kernel=5, stride=2){
            Convolution(kernel=(kernel,kernel),channels=channels) ->
            Relu()         
        }

	data ->
	AdaNet(block="conv")->
        softmax;
    }
}
